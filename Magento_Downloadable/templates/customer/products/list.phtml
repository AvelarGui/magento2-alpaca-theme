<?php $_items = $block->getItems(); ?>
<?php if (count($_items)): ?>
    <div class="dashboard-table">
        <div class="dashboard-table__header">
            <h5 class="heading heading--fifth-level dashboard-table__title">
                <?php /* @escapeNotVerified */ echo __('My Downloadable Products') ?>
            </h5>
        </div>
        
        <div class="dashboard-table__content">
            <table id="my-downloadable-products-table" class="table">
                <thead>
                    <tr>
                        <th scope="col" class="id">
                            <?php /* @escapeNotVerified */ echo __('Order #') ?>
                        </th>

                        <th scope="col" class="date">
                            <?php /* @escapeNotVerified */ echo __('Date') ?>
                        </th>

                        <th scope="col" class="title">
                            <?php /* @escapeNotVerified */ echo __('Title') ?>
                        </th>

                        <th scope="col" class="status">
                            <?php /* @escapeNotVerified */ echo __('Status') ?>
                        </th>

                        <th scope="col" class="remaining">
                            <?php /* @escapeNotVerified */ echo __('Remaining Downloads') ?>
                        </th>
                    </tr>
                </thead>
                
                <tbody>
                    <?php foreach ($_items as $_item): ?>
                        <tr>
                            <td data-th="<?php echo $block->escapeHtml(__('Order #')) ?>" class="id">
                                <a href="<?php /* @escapeNotVerified */ echo $block->getOrderViewUrl($_item->getPurchased()->getOrderId()) ?>"
                                   title="<?php echo $block->escapeHtml(__('View Order')) ?>"
                                >
                                    <?php /* @escapeNotVerified */ echo $_item->getPurchased()->getOrderIncrementId() ?>
                                </a>
                            </td>

                            <td data-th="<?php echo $block->escapeHtml(__('Date')) ?>" class="date">
                                <?php /* @escapeNotVerified */ echo $block->formatDate($_item->getPurchased()->getCreatedAt()) ?>
                            </td>

                            <td data-th="<?php echo $block->escapeHtml(__('Title')) ?>" class="title">
                                <strong class="product-name">
                                    <?php echo $block->escapeHtml($_item->getPurchased()->getProductName()) ?>
                                </strong>

                                <?php if ($_item->getStatus() == \Magento\Downloadable\Model\Link\Purchased\Item::LINK_STATUS_AVAILABLE): ?>
                                    <a href="<?php /* @escapeNotVerified */ echo $block->getDownloadUrl($_item) ?>" 
                                       title="<?php echo $block->escapeHtml(__('Start Download')) ?>" 
                                       class="link download" <?php echo $block->getIsOpenInNewWindow() ? 'onclick="this.target=\'_blank\'"' : ''; ?>
                                    >
                                        <?php echo $block->escapeHtml($_item->getLinkTitle()) ?>
                                    </a>
                                <?php endif; ?>
                            </td>

                            <td data-th="<?php echo $block->escapeHtml(__('Status')) ?>" class="status">
                                <?php /* @escapeNotVerified */ echo __(ucfirst($_item->getStatus())) ?>
                            </td>

                            <td data-th="<?php echo $block->escapeHtml(__('Remaining Downloads')) ?>" class="remaining">
                                <?php /* @escapeNotVerified */ echo $block->getRemainingDownloads($_item) ?>
                            </td>
                        </tr>
                    <?php endforeach; ?>
                </tbody>
            </table>
        </div>
    </div>

    <?php if ($block->getChildHtml('pager')): ?>
        <?php echo $block->getChildHtml('pager'); ?>
    <?php endif; ?>

<?php else: ?>
    <div class="message info empty">
        <?php /* @escapeNotVerified */ echo __('You have not purchased any downloadable products yet.'); ?>
    </div>
<?php endif; ?>

<div class="action">
    <div class="action__handler">
        <a href="<?php echo $block->escapeUrl($block->getBackUrl()) ?>" 
           class="link action__link"
        >
            <?php /* @escapeNotVerified */ echo __('Back') ?>
        </a>
    </div>
</div>
