<?php
$swatchData = $block->getSwatchData();
$swatchCode = $swatchData['attribute_code'] . 'Filter';
$swatchLabel = $swatchData['attribute_label'];
?>
<li
    class="
        dropdown-list__item
        dropdown-list__item--collapse
        filter
        swatch-layered
        <?= $block->escapeHtmlAttr($swatchCode) ?>
    "
>
    <div
        class="
            dropdown-list__label-wrapper
            filter__label-wrapper
        "
    >
        <button
            type="button"
            class="dropdown-list__label"
            aria-controls="<?= $swatchCode ?>"
            aria-expanded="true"
        >
            <h3 class="filter__heading">
                <?= $swatchLabel; ?>
            </h3>
            <svg
                class="
                    icon
                    dropdown-list__icon
                "
                role="presentation"
                focusable="false"
            >
                <title><?= __('Arrow down') ?></title>
                <use xlink:href="<?= $block->escapeUrl($block->getViewFileUrl('images/icons-sprite.svg#angle-down')); ?>"></use>
            </svg>
        </button>
    </div>

    <div
        class="
            dropdown-list__content
            filter__content
        "
        id="<?= $swatchCode ?>"
        aria-hidden="false"
    >
        <div
            class="more-info margin-bottom-xs"
            data-mage-init='{ "moreInfo": { } }'
        >
            <!--TO DO - get data from module snowdog/module-product-attribute-description (#60916)-->
            <button
                class="
                    button
                    button--icon
                    button--fluid
                    more-info__trigger
                "
                type="button"
                aria-expanded="false"
            >
                <span class="button__text">
                    <?= __('More information') ?>
                </span>
                <svg
                    class="
                        icon
                        button__icon
                    "
                    role="presentation"
                    focusable="false"
                >
                    <title><?= __('Show tooltip') ?></title>
                    <use xlink:href="<?= $block->escapeUrl($block->getViewFileUrl('images/icons-sprite.svg#info')); ?>"></use>
                </svg>
            </button>

            <div
                class="more-info__content-wrapper"
                aria-hidden="true"
            >
                <div class="more-info__content">
                    <h3 class="more-info__heading">
                        Example title
                    </h3>

                    Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aliquam venenatis nisl quis imperdiet tincidunt. Nulla massa diam, aliquet vitae laoreet a, fermentum eu velit. Quisque ornare erat in orci hendrerit feugiat at sit amet neque. Fusce elementum semper feugiat. Curabitur egestas neque in leo finibus ultricies.

                    <button
                        class="
                            button
                            button--icon
                            button--rotate-icon
                            more-info__close
                        "
                        type="button"
                        aria-label="<?= $block->escapeHtmlAttr(__('Close more information')) ?>"
                    >
                        <svg
                            class="icon"
                            role="presentation"
                            focusable="false"
                        >
                            <title><?= __('Close') ?></title>
                            <use xlink:href="<?= $block->escapeUrl($block->getViewFileUrl('images/icons-sprite.svg#close')); ?>"></use>
                        </svg>
                    </button>
                </div>
            </div>
        </div>

        <ul
            class="
                list
                filter__list
            "
            attribute-code="<?= $block->escapeHtmlAttr($swatchCode) ?>"
            attribute-id="<?= $block->escapeHtmlAttr($swatchData['attribute_id']) ?>"
        >
            <?php foreach ($swatchData['options'] as $option => $label): ?>
                <?php if (isset($swatchData['swatches'][$option]['type'])): ?>
                    <?php
                    switch ($swatchData['swatches'][$option]['type']) {
                        case '3': //other swatches
                    ?>
                        <li
                            class="
                                filter__swatch-item
                                <?= $block->escapeHtmlAttr($label['custom_style']) ?>
                            "
                        >
                            <a
                                class="filter__swatch-option"
                                href="<?= $block->escapeUrl($label['link']) ?>"
                                aria-label="<?= $block->escapeHtmlAttr($label['label']) ?>"
                            >
                                <div
                                    option-type="3"
                                    option-id="<?= $block->escapeHtmlAttr($option) ?>"
                                    option-label="<?= $block->escapeHtmlAttr($label['label']) ?>"
                                ></div>
                            </a>
                        </li>
                    <?php
                            break;
                        case '2': //color swatch with image background
                    ?>
                        <?php $swatchThumbPath = $block->getSwatchPath(
                            'swatch_thumb',
                            $swatchData['swatches'][$option]['value']
                        ); ?>
                        <?php $swatchImagePath = $block->getSwatchPath(
                            'swatch_image',
                            $swatchData['swatches'][$option]['value']
                        ); ?>
                        <li
                            class="
                                filter__color-item
                                <?= $block->escapeHtmlAttr($label['custom_style']) ?>
                            "
                        >
                            <a
                                href="<?= $block->escapeUrl($label['link']) ?>"
                                aria-label="<?= $block->escapeHtmlAttr($label['label']) ?>"
                                class="filter__color-option"
                            >
                                <div
                                    class="filter__color-sample"
                                    option-type="2"
                                    option-id="<?= $block->escapeHtmlAttr($option) ?>"
                                    option-label="<?= $block->escapeHtmlAttr($label['label']) ?>"
                                    option-tooltip-thumb="<?= $block->escapeHtmlAttr($swatchThumbPath) ?>"
                                    style="
                                        background: url(<?= $block->escapeUrl($swatchImagePath) ?>) no-repeat center;
                                        background-size: cover;
                                    "
                                    title="<?= $block->escapeHtmlAttr($label['label']) ?>"
                                ></div>
                                <span class="filter__color-label">
                                    <?= $label['label'] ?>
                                </span>
                            </a>
                        </li>
                    <?php
                            break;
                        case '1': //color swatch with #hex background
                    ?>
                        <li
                            class="
                                filter__color-item
                                <?= $block->escapeHtmlAttr($label['custom_style']) ?>
                            "
                        >
                            <a
                                href="<?= $block->escapeUrl($label['link']) ?>"
                                class="filter__color-option"
                            >
                                <div
                                    class="filter__color-sample"
                                    option-type="1"
                                    option-id="<?= $block->escapeHtmlAttr($option) ?>"
                                    option-label="<?= $block->escapeHtmlAttr($label['label']) ?>"
                                    option-tooltip-value="<?= $block->escapeHtmlAttr($swatchData['swatches'][$option]['value']) ?>"
                                    style="background: <?= $block->escapeHtmlAttr($swatchData['swatches'][$option]['value']) ?>"
                                ></div>
                                <span class="filter__color-label">
                                    <?= $label['label'] ?>
                                </span>
                            </a>
                        </li>
                    <?php
                            break;
                        case '0': //text swatch
                        default:
                    ?>
                        <li
                            class="
                                filter__swatch-item
                                <?= $block->escapeHtmlAttr($label['custom_style']) ?>
                            "
                        >
                            <a
                                href="<?= $block->escapeUrl($label['link']) ?>"
                                class="filter__swatch-option"
                                option-type="0"
                                option-id="<?= $block->escapeHtmlAttr($option) ?>"
                                option-label="<?= $block->escapeHtmlAttr($label['label']) ?>"
                            >
                                <?= $swatchData['swatches'][$option]['value'] ?>
                            </a>
                        </li>
                    <?php
                            break;
                    }
                    ?>
                <?php endif; ?>
            <?php endforeach; ?>
        </ul>
        <script>
            require(
                [
                    "jquery",
                    "Magento_Swatches/js/swatch-renderer"
                ],
                function ($)
                {
                    $('.swatch-layered.<?= $block->escapeHtmlAttr($swatchCode) ?>')
                        .find('[option-type="1"], [option-type="2"], [option-type="0"], [option-type="3"]')
                        .SwatchRendererTooltip();
                }
            );
        </script>
    </div>
</li>
