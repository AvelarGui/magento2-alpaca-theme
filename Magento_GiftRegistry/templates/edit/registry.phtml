<?php
// phpcs:disable Magento2.Templates.ThisInTemplate
// phpcs:disable Magento2.Files.LineLength.MaxExceeded

/** @var $block \Magento\GiftRegistry\Block\Customer\Edit\Registry */
?>

<input type="hidden" name="entity_id" id="entity_id" value="<?= $block->escapeHtmlAttr($block->getEntity()->getEntityId())?>" />
<input type="hidden" name="type_id" id="type_id" value="<?= $block->escapeHtmlAttr($block->getTypeId()) ?>" />

<p class="giftregistry-type">
    <span class="label"><?= $block->escapeHtml(__('Type:')) ?></span>
    <strong><?= $block->escapeHtml($block->getTypeLabel()) ?></strong>
</p>

<fieldset class="fieldset">
    <legend class="fieldset__legend fieldset__legend--hidden"><span><?= $block->escapeHtml(__('General Information')) ?></span></legend>

    <div class="input event required">
        <label for="title" class="label"><span><?= $block->escapeHtml(__('Event')) ?></span></label>
        <input type="text" name="title" id="title" value="<?= $block->escapeHtmlAttr($block->getEntity()->getTitle()) ?>" title="<?= $block->escapeHtmlAttr(__('Event')) ?>" class="input__field" data-validate="{required:true}" />
    </div>
    <div class="input textarea required">
        <label for="message" class="label"><span><?= $block->escapeHtml(__('Message')) ?></span></label>
        <textarea name="message" id="message" class="input__field input__field--textarea" cols="5" rows="3" title="<?= $block->escapeHtmlAttr(__('Message')) ?>" data-validate="{required:true}" ><?= $block->escapeHtml($block->getEntity()->getMessage()) ?></textarea>
    </div>
    <div class="input privacy required">
        <label for="is_public" class="label"><span><?= $block->escapeHtml(__('Privacy Settings')) ?></span></label>
        <?= $block->getIsPublicHtml() ?>
    </div>
    <div class="input status required">
        <label for="select" class="label"><span><?= $block->escapeHtml(__('Status')) ?></span></label>
        <?= $block->getStatusHtml() ?>
    </div>
</fieldset>

<?php
$fieldsets = $block->getGroupedRegistryAttributes();
foreach ($fieldsets as $fieldset => $fields) : ?>
<fieldset class="fieldset">
    <legend class="legend"><span><?= $block->escapeHtml($block->getGroupLabel($fieldset)) ?></span></legend>

    <?php foreach ($fields as $field => $data) : ?>
        <?php $isRequired = $block->isAttributeRequired($data); ?>
        <div class="field<?= ($isRequired ? ' required' : ''); ?><?= $field == 'event_date' ? ' date' : '' ?>">
            <label for="<?= $block->escapeHtmlAttr($field) ?>" class="label"><span><?= $block->escapeHtml(__($data['label'])) ?></span></label>
            <div class="control">
                <?= /* @noEscape */ $block->renderField($data, $field) ?>
            </div>
        </div>
    <?php endforeach; ?>
    <?php foreach ($fields as $field => $data) : ?>
        <?php if ($block->useRegionUpdater($data)) : ?>
        <script type="text/x-magento-init">
        {
            "#<?= $block->escapeJs($field) ?>": {
                "regionUpdater": {
                    "optionalRegionAllowed": <?= ($block->getConfig('general/region/display_all') ? 'true' : 'false') ?>,
                    "regionListId": "#<?= $block->escapeJs($field) ?>_region",
                    "regionInputId": "#<?= $block->escapeJs($field) ?>_region_text",
                    "isRegionRequired": false,
                    "isZipRequired": false,
                    "isCountryRequired": true,
                    <?php if ($block->getEntity()->getFieldValue($data['id'] . '_region')) : ?>
                    "currentRegion": <?= $block->escapeJs($block->getEntity()->getFieldValue($data['id'] . '_region')) ?>,
                    <?php endif; ?>
                    "regionJson": <?= /* @noEscape */ $this->helper(Magento\Directory\Helper\Data::class)->getRegionJson() ?>
                }
            }
        }
        </script>
        <?php endif; ?>
    <?php endforeach; ?>
</fieldset>
<?php endforeach; ?>
